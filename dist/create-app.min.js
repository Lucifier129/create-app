/*!
 * create-app.js v0.1.1
 * (c) 2016 Jade Gu
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("history/lib/createMemoryHistory"),require("path-to-regexp"),require("history/lib/createBrowserHistory"),require("history/lib/createHashHistory"),require("history/lib/useQueries"),require("history/lib/useBeforeUnload"),require("history/lib/useBasename")):"function"==typeof define&&define.amd?define(["history/lib/createMemoryHistory","path-to-regexp","history/lib/createBrowserHistory","history/lib/createHashHistory","history/lib/useQueries","history/lib/useBeforeUnload","history/lib/useBasename"],t):e.App=t(e.createMemoryHistory,e.pathToRegexp,e.createHistory,e.createHashHistory,e.useQueries,e.useBeforeUnload,e.useBasename)}(this,function(e,t,r,o,n,i,a){"use strict";function u(e){return"function"==typeof e}function c(e){return null!=e&&u(e.then)}function p(e){return e}function l(e,t){if(!t)return e;for(var r=Object.keys(t),o=r.length;o--;)e[r[o]]=t[r[o]];return e}function s(e){var t=e.map(f),r=t.length;return function(e){for(var o=h(e),n=0;n<r;n++){var i=t[n],a=i.regexp.exec(o);if(a){var u=y(a,i.keys),c=i.controller;return{path:i.path,params:u,controller:c}}}}}function f(e){var r=l({},e),o=r.keys=[];return r.regexp=t(r.path,o),r}function y(e,t){for(var r={},o=1,n=e.length;o<n;o++){var i=t[o-1];i&&("string"==typeof e[o]?r[i.name]=decodeURIComponent(e[o]):r[i.name]=e[o])}return r}function h(e){return e.replace(/\/\//g,"/")}function d(e){function t(){return j?j:j="string"==typeof x?document.querySelector(x):x}function r(e){var t="string"==typeof e?C.createLocation(e):e;if(O){var r=O.pathname===t.pathname,o=O.search===t.search,i=O.hash===t.hash;if(r&&o&&i)return}O=t;var a=H(t.pathname);if(!a)throw new Error("Did not match any route with pathname:"+t.pathname);var u=a.path,p=a.params,l=a.controller;t.pattern=u,t.params=p;var s=typeof l,f=n(t);if("string"===s){var y=v(l,f,t);return c(y)?y.then(f):y}if("function"===s){var y=l(t,v);return c(y)?y.then(f):f(y)}}function o(e,r){if(U.hasOwnProperty(e))return U[e];var o=function(e){function r(t,o){w.classCallCheck(this,r),e.call(this,t,o),this.location=this.location||t,this.context=this.context||o}return w.inherits(r,e),r.prototype.goReplace=function(t){e.prototype.goReplace&&e.prototype.goReplace.call(this,t),C.replace(t)},r.prototype.goTo=function(t){e.prototype.goTo&&e.prototype.goTo.call(this,t),C.push(t)},r.prototype.goIndex=function(t){e.prototype.goIndex&&e.prototype.goIndex.call(this,t),C.go(t)},r.prototype.goBack=function(){e.prototype.goBack&&e.prototype.goBack.call(this),C.goBack()},r.prototype.goForward=function(){e.prototype.goForward&&e.prototype.goForward.call(this),C.goForward()},r.prototype.refreshView=function(){return e.prototype.refreshView&&e.prototype.refreshView.call(this),i(this.render())},r.prototype.getContainer=function(){return e.prototype.getContainer&&e.prototype.getContainer.call(this),t()},r.prototype.clearContainer=function(){return e.prototype.clearContainer&&e.prototype.clearContainer.call(this),a()},r}(r);return U[e]=o,o}function n(e){return function(t){k&&u();var r=o(e.pattern,t),n=k=new r(e,m),a=null,p=null;if(n.beforeLeave){var l=n.beforeLeave.bind(n);a=C.listenBefore(l)}if(n.beforeUnload){var s=n.beforeUnload.bind(n);p=C.listenBeforeUnload(s)}n.$unlisten=function(){a&&(a(),a=null),p&&(p(),p=null)};var f=n.init();return f?c(f)?f.then(i):i(f):null}}function i(e){return d.render(e,t())}function a(){if(d.clear)return d.clear(t())}function u(){k&&(k.$unlisten(),k.destroy&&k.destroy(),k=null),a()}function p(){T=C.listen(r),r(C.getCurrentLocation())}function f(){T&&(T(),T=null),u()}var y=l({viewEngine:B},b);l(y,e);var h=y.routes,d=y.viewEngine,v=y.loader,m=y.context,x=y.container,C=g(y),H=s(h),k=null,O=null,T=null,j=null,U={};return{start:p,stop:f,render:r,history:C}}function g(e){var t=C[e.type];return t=C.useBasename(t),t=C.useBeforeUnload(t),(t=C.useQueries(t))(e)}function v(e){function t(e,t){var r=d.createLocation(e),n=h(r.pathname);if(!n)return void t(new Error("Did not match any route with path:"+e));var i=n.path,a=n.params,u=n.controller;r.pattern=i,r.params=a;var p=o(r,t),l=typeof u;if("string"===l){var s=f(u,p,r);return c(s)?s.then(p,t):s}if("function"===l){var s=u(r,f);return c(s)?s.then(p,t):p(s)}}function r(e,r){if(g.hasOwnProperty(e))return g[e];var o=function(e){function r(t,o){w.classCallCheck(this,r),e.call(this,t,o),this.location=this.location||t,this.context=this.context||o}return w.inherits(r,e),r.prototype.goReplace=function(r){return e.prototype.goReplace&&e.prototype.goReplace.call(this,r),t(r)},r.prototype.goTo=function(r){return e.prototype.goTo&&e.prototype.goTo.call(this,r),t(r)},r.prototype.goIndex=function(t){e.prototype.goIndex&&e.prototype.goIndex.call(this,t)},r.prototype.goBack=function(){e.prototype.goBack&&e.prototype.goBack.call(this)},r.prototype.goForward=function(){e.prototype.goForward&&e.prototype.goForward.call(this)},r.prototype.refreshView=function(){e.prototype.refreshView&&e.prototype.refreshView.call(this)},r.prototype.getContainer=function(){e.prototype.getContainer&&e.prototype.getContainer.call(this)},r.prototype.clearContainer=function(){e.prototype.clearContainer&&e.prototype.clearContainer.call(this)},r}(r);return g[e]=o,o}function o(e,t){return function(o){var i=r(e.pattern,o),a=new i(e,y),u=a.init();if(c(u)){var p=u.then(n);return t?p.then(function(e){return t(null,e)},t):p}var l=n(u);return t&&t(null,l),l}}function n(e){return p.render(e)}function i(e,r){try{return t(e,r)}catch(e){r(e)}}var a=l({viewEngine:k},b);l(a,e);var u=a.routes,p=a.viewEngine,f=a.loader,y=a.context,h=s(u),d=m(a),g={};return{render:i,history:d}}function m(t){var r=e;return r=C.useBasename(r),(r=C.useQueries(r))(t)}e="default"in e?e.default:e,t="default"in t?t.default:t,r="default"in r?r.default:r,o="default"in o?o.default:o,n="default"in n?n.default:n,i="default"in i?i.default:i,a="default"in a?a.default:a;var w={};w.inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},w.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Object.freeze||(Object.freeze=p);var b={basename:"",context:{},type:"createHistory"},x=function(e,t){return t.innerHTML=e,t},B=Object.freeze({render:x}),C={createHistory:r,createHashHistory:o,useQueries:n,useBeforeUnload:i,useBasename:a},H=function(e){return e.toString()},k=Object.freeze({render:H}),O={server:v,client:d};return O});